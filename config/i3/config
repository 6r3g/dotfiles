# i3 config file (v4)
exec_always --no-startup-id "xmodmap ~/.config/xmodmap/Xmodmap"
set $Alt Mod1
set $CapsLock Mod3
set $Super Mod4
font pango:UbuntuMono Nerd Font 10

for_window [class=".*"] title_format "%class - %title"

exec_always --no-startup-id "picom --config ~/.config/picom/picom.conf"
exec --no-startup-id "dex --autostart --environment i3"
exec --no-startup-id "unclutter -idle 3 -root"
exec --no-startup-id "gammastep-indicator"
#exec --no-startup-id "xfce4-clipman"
exec --no-startup-id "feh --no-fehbg --bg-scale ~/Pictures/Wallpapers/base.jpg"
exec --no-startup-id "i3-sensible-terminal"
exec --no-startup-id "xfce4-terminal --role=ScratchTerm --title=ScratchTerm"
exec --no-startup-id "/usr/bin/thunar"
#exec "touch $XDG_RUNTIME_DIR/i3/swap_focus.pid && ~/.local/bin/i3-swap-focus"
exec "i3-swap-focus"

# no title, borders and gaps specs
default_border pixel 2
default_floating_border pixel 2
hide_edge_borders smart
smart_gaps on
gaps inner 5px
gaps outer -3px

# focus don't follow mouse position
focus_follows_mouse no

# Use pactl to adjust volume in PulseAudio.
set $refresh_i3status killall -SIGUSR1 i3status
bindsym XF86AudioRaiseVolume exec --no-startup-id "pactl set-sink-volume @DEFAULT_SINK@ +5% && $refresh_i3status"
bindsym XF86AudioLowerVolume exec --no-startup-id "pactl set-sink-volume @DEFAULT_SINK@ -5% && $refresh_i3status"
bindsym XF86AudioMute exec --no-startup-id "pactl set-sink-mute @DEFAULT_SINK@ toggle && $refresh_i3status"
bindsym XF86AudioMicMute exec --no-startup-id "pactl set-source-mute @DEFAULT_SOURCE@ toggle && $refresh_i3status"

# Use Mouse+$Super to drag floating windows to their wanted position
floating_modifier $Super
tiling_drag modifier titlebar

# lock screen
# (ctrl_r=105)
bindcode $Super+Shift+105 exec "~/.config/scripts/i3_blur-lock.sh"

# start a terminal
# (return=36)
bindcode $Super+36 exec i3-sensible-terminal

# kill focused window
# (q=38)
bindcode $Super+Shift+38 kill
bindcode $CapsLock+38 kill

# start dmenu (a program launcher)
# (d=40)
bindcode $Super+40 exec "rofi -modi drun,run -show drun"

# Apps
# (w=52;n=57;printscr=107)
bindcode $Super+52 exec "/usr/bin/firefox"
bindcode $Super+Shift+57 exec "/usr/bin/thunar"
bindcode 107 exec "/usr/bin/flameshot gui"

# change focus
# (left=113;down=116;up=111;right=114)
# (h=43;j=44;k=45;l=46)
bindcode $Super+113 focus left
bindcode $Super+43 focus left
bindcode $Super+116 focus down
bindcode $Super+44 focus down
bindcode $Super+111 focus up
bindcode $Super+45 focus up
bindcode $Super+114 focus right
bindcode $Super+46 focus right

# move focused window
# (left=113;down=116;up=111;right=114)
# (h=43;j=44;k=45;l=46)
bindcode $Super+Shift+113 move left
bindcode $Super+Shift+43 move left
bindcode $Super+Shift+116 move down
bindcode $Super+Shift+44 move down
bindcode $Super+Shift+111 move up
bindcode $Super+Shift+45 move up
bindcode $Super+Shift+114 move right
bindcode $Super+Shift+46 move right

# resize window 
# (left=113;down=116;up=111;right=114)
# (h=43;j=44;k=45;l=46)
bindcode $Super+$Alt+113 resize shrink width 5 px
bindcode $Super+$Alt+43 resize shrink width 5 px
bindcode $Super+$Alt+114 resize grow width 5 px
bindcode $Super+$Alt+44 resize grow width 5 px
bindcode $Super+$Alt+116 resize shrink height 5 px
bindcode $Super+$Alt+45 resize shrink height 5 px
bindcode $Super+$Alt+111 resize grow height 5 px
bindcode $Super+$Alt+46 resize grow height 5 px

# split in horizontal/vertical and toggle between us
# (g=42;v=55;z=25)
bindcode $Super+42 split h
bindcode $Super+55 split v
bindcode $Super+25 layout toggle split

# fullscreen mode for the focused container
# (f=41)
bindcode $Super+41 fullscreen toggle

# back and forth, change workspace
workspace_auto_back_and_forth yes
# (tab=23)
bindcode $Super+23 workspace back_and_forth
bindcode $Super+Shift+23 exec pkill -USR1 -F "${XDG_RUNTIME_DIR}/swap_focus.pid"
bindcode $Super+Ctrl+113 workspace prev
bindcode $Super+Ctrl+114 workspace next

# default layout, change container layout (stacked, tabbed, toggle split)
workspace_layout tabbed
# (e=26;t=28)
bindcode $Super+26 layout toggle splith tabbed
bindcode $Super+28 layout tabbed

# change focus between tiling / floating windows
# (space=65)
bindcode $Super+65 focus mode_toggle
bindcode $Super+Shift+65 floating toggle

# focus the parent/child container
# (a=24)
bindcode $Super+24 focus parent
bindcode $Super+Shift+24 focus child

# Assign program to workspace
assign [class="Xfce4-terminal" window_role="^(?i)(?!ScratchTerm).*"] 1
assign [class="(?i)firefox"] 2
assign [class="Code"] 3
assign [class="Ristretto"] 6
assign [class="VirtualBox Manager"] 10

# Auto-focus
focus_on_window_activation focus
for_window [class="Xfce4-terminal"] focus
for_window [class="(?i)firefox"] focus
for_window [class="Thunar"] focus
for_window [class="Ristretto"] focus

# Window specifics

# Scratchpad stuffs (s=39;n=57;b=56;exclam/slash=61)
bindcode $Super+Shift+39 move scratchpad
bindcode $Super+39 exec "rofi -show scratchpad -modi scratchpad:~/.config/scripts/rofi_i3_scratchpad.sh"
bindcode $Super+57 [class=Thunar] scratchpad show
bindcode $Super+56 [title="Extension: (Bitwarden Password Manager)*"] scratchpad show
bindcode $Super+61 [window_role="ScratchTerm"] scratchpad show

# floating rules
# WM_CLASS(STRING) = "instance", "class"
for_window [window_role=page-info|pop-up|bubble|task_dialog|Preferences|dialog|menu|About] floating enable
for_window [class="qt5ct" instance="qt5ct"] floating enable
for_window [class="Nm-connection-editor"] floating enable
for_window [window_role="GtkFileChooserDialog"] floating enable, resize set 900 620, move absolute position center
for_window [class="Thunar" title="(?i)- Thunar"] floating enable, mark --add "ignore_focus", move scratchpad, resize set 1280 800, move absolute position center
for_window [class="VirtualBox" title="(?i)- Settings"] floating enable, resize set 1280 720, move absolute position center
for_window [class="VirtualBox" title="(?i)- Preferences"] floating enable, resize set 1280 720, move absolute position center
for_window [class="Wireshark" title="(?i)Â·"] floating enable, resize set 1280 720, move absolute position center
for_window [class="Xarchiver"] floating enable, resize set 1280 720, move absolute position center
for_window [class="transmission-gtk"] floating enable, resize set 900 720, move absolute position center
for_window [class="Blueman-manager"] floating enable, resize set 900 720, move absolute position center
for_window [class="flameshot"] floating enable, resize set 720 720, move absolute position center
for_window [class="Arandr"] floating enable, resize set 720 720, move absolute position center
for_window [class="Lxappearance"] floating enable, resize set 900 620, move absolute position center
for_window [class="Signal"] floating enable, resize set 900 820, move absolute position center
for_window [class="Xfce4-terminal" window_role="ScratchTerm"] floating enable, mark --add "ignore_focus", move scratchpad, resize set 1600 900, move absolute position center
for_window [class="Espanso"] floating enable,mark --add "ignore_focus", resize set 875 375, move absolute position center
for_window [class="firefox-esr" title="(?i)Extension: (Bitwarden Password Manager)*"] floating enable, mark --add "ignore_focus", move scrathpad
for_window [class="ColorPicker"] floating enable,mark --add "ignore_focus", resize set 860 780
for_window [title="(?i)FIDO2.1 Manager*"] floating enable,mark --add "ignore_focus", resize set 860 780
for_window [title="(?i)Resident Keys*"] floating enable,mark --add "ignore_focus", resize set 860 780
for_window [title="(?i)Document Print Status*"] floating enable,mark --add "ignore_focus", resize set 550 250, move absolute position center
for_window [title="(?i)Print Settings*"] floating enable,mark --add "ignore_focus", resize set 550 450, move absolute position center


# switch to workspace
bindcode $Super+10 workspace number 1
bindcode $Super+11 workspace number 2
bindcode $Super+12 workspace number 3
bindcode $Super+13 workspace number 4
bindcode $Super+14 workspace number 5
bindcode $Super+15 workspace number 6
bindcode $Super+16 workspace number 7
bindcode $Super+17 workspace number 8
bindcode $Super+18 workspace number 9
bindcode $Super+19 workspace number 10
bindcode $CapsLock+10 workspace number 11
bindcode $CapsLock+11 workspace number 12
bindcode $CapsLock+12 workspace number 13
bindcode $CapsLock+13 workspace number 14
bindcode $CapsLock+14 workspace number 15
bindcode $CapsLock+15 workspace number 16
bindcode $CapsLock+16 workspace number 17
bindcode $CapsLock+17 workspace number 18
bindcode $CapsLock+18 workspace number 19
bindcode $CapsLock+19 workspace number 20

# move focused container to workspace
bindcode $Super+Shift+10 move container to workspace number 1
bindcode $Super+Shift+11 move container to workspace number 2
bindcode $Super+Shift+12 move container to workspace number 3
bindcode $Super+Shift+13 move container to workspace number 4
bindcode $Super+Shift+14 move container to workspace number 5
bindcode $Super+Shift+15 move container to workspace number 6
bindcode $Super+Shift+16 move container to workspace number 7
bindcode $Super+Shift+17 move container to workspace number 8
bindcode $Super+Shift+18 move container to workspace number 9
bindcode $Super+Shift+19 move container to workspace number 10
bindcode $CapsLock+Shift+10 move container to workspace number 11
bindcode $CapsLock+Shift+11 move container to workspace number 12
bindcode $CapsLock+Shift+12 move container to workspace number 13
bindcode $CapsLock+Shift+13 move container to workspace number 14
bindcode $CapsLock+Shift+14 move container to workspace number 15
bindcode $CapsLock+Shift+15 move container to workspace number 16
bindcode $CapsLock+Shift+16 move container to workspace number 17
bindcode $CapsLock+Shift+17 move container to workspace number 18
bindcode $CapsLock+Shift+18 move container to workspace number 19
bindcode $CapsLock+Shift+19 move container to workspace number 20

# reload config file / restart or exit i3wm
# (c=54;r=27;e=26;backspace=22)
bindcode $Super+Shift+54 reload
bindcode $Super+Shift+27 restart
bindcode $Super+Shift+22 exec "rofi -show power-menu -modi power-menu:~/.config/scripts/rofi_power-menu.sh"

# arandr / xrandr change layout
# (d=40)
bindcode $Super+Shift+40 exec "~/.config/scripts/rofi_change-layout.sh"
# tailscale command
# (x=53)
bindcode $Super+Shift+53 exec "~/.config/scripts/rofi_tailscale.sh"
# virtualbox quick access
# (v=55)
bindcode $Super+Shift+55 exec "~/.config/scripts/rofi_virtualbox.sh"

# move floating windows with keys
# (m=47)
# (left=113;down=116;up=111;right=114)
# (h=43;j=44;k=45;l=46)
bindcode $Super+47 mode "move" focus floating
mode "move" {
    bindcode 113 move left
	bindcode 43 move left
    bindcode 116 move down
	bindcode 44 move down
    bindcode 111 move up
	bindcode 45 move up
    bindcode 114 move right
	bindcode 46 move right
    # back to normal: Enter or Escape
	# (escape=9)
    bindcode 9 mode "default"
}

# Catppuccin Mocha colors
set $rosewater #f5e0dc
set $flamingo  #f2cdcd
set $pink      #f5c2e7
set $mauve     #cba6f7
set $red       #f38ba8
set $maroon    #eba0ac
set $peach     #fab387
set $yellow    #f9e2af
set $green     #a6e3a1
set $teal      #94e2d5
set $sky       #89dceb
set $sapphire  #74c7ec
set $blue      #89b4fa
set $lavender  #b4befe
set $text      #cdd6f4
set $subtext1  #bac2de
set $subtext0  #a6adc8
set $overlay2  #9399b2
set $overlay1  #7f849c
set $overlay0  #6c7086
set $surface2  #585b70
set $surface1  #45475a
set $surface0  #313244
set $base      #1e1e2e
set $mantle    #181825
set $crust     #11111b

# class                 border  backgr. text    indicator child_border
client.focused          #4c7899 #285577 #ffffff $green    $green
client.focused_inactive #333333 #5f676a #ffffff #484e50   #5f676a
client.unfocused        #333333 #222222 #888888 #292d2e   #222222
client.urgent           #2f343a #900000 #ffffff #900000   #900000
client.placeholder      #000000 #0c0c0c #ffffff #000000   #0c0c0c

bar {
        position bottom
        status_command i3status
	  colors {
	    background         $base
	    statusline         $text
	    separator          $text
	    focused_statusline $text
	    active_workspace   $base $text $blue
	    focused_separator  $base
	    focused_workspace  $base $base $green
	    active_workspace   $base $base $blue
	    inactive_workspace $base $base $surface1
	    urgent_workspace   $base $base $surface1
	    binding_mode       $base $base $surface1
	  }
}

# useful
# https://wiki.linuxquestions.org/wiki/List_of_keysyms
